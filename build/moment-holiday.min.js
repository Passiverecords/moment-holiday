//! moment-holiday.js
//! version : 2.0
//! author: Benjamin Dequevauviller
//! forked from : Kodie Grantham
//! license : MIT
//! forked from :  https://github.com/kodie/moment-holiday
//! https://github.com/passiverecords/moment-holiday
(function(){var _=require("moment"),x=[],v=function(t,e,r){for(var a,i=[],n=0;n<x.length;n++){var o=x[n](t,e);(o||!1===o)&&(a=o)}if(!1===a)return!1;if("string"==typeof a?e=a:a&&(i=a),!_.isMoment(i)&&!i.length&&e.charAt(0).match(/[0-9(]/)){var s=!1,h=e.split("|");1<h.length&&(s=!0),2<h.length&&(h=[h[0],h[1]]);for(n=0;n<h.length;n++){var l=_(t),f=h[n].split("/");if(1===f.length||2===f.length&&"("!==f[1].charAt(0)&&4===f[1].length){var d=h[n];n=-1,h=[];for(var y=1;y<13;y++)h.push(y+"/"+d)}else if(2<f.length&&l.year(parseInt(f[2])),l.month(parseInt(f[0])-1),"("===f[1].charAt(0)){var c=f[1].slice(1,-1).split(","),u=parseInt(c[0]),v=parseInt(c[1]),g=_(l).startOf("month"),p=_(l).endOf("month").diff(g,"days")+1,O=[];if(c[1]&&"["===c[1].charAt(0)){var b=!0;(v=parseInt(c[1].slice(1,-1)))<0&&(b=!1,v=parseInt(c[1].slice(2,-1))),g=_(l).date(v);for(var k=0;k<7;k++){if(g.day()===u){i.push(_(g));break}b?g.add(1,"day"):g.subtract(1,"day")}continue}for(var w=0;w<p;w++)g.day()===u&&O.push(_(g)),g.add(1,"day");if(!v){i=i.concat(O);continue}l=v<0?O[O.length+v]:O[v-1],i.push(l)}else i.push(l.date(f[1]))}if(s&&1<i.length){var m=i[1].diff(i[0],"days");if(1<m){var j=_(i[0]);i=[i[0]];for(n=0;n<m;n++)j.add(1,"day"),i.push(_(j))}}}i=P(i);for(n=0;n<i.length;n++)_.isMoment(i[n])?(r&&(0===i[n].day()&&(i[n]=i[n].add(1,"day")),6===i[n].day()&&(i[n]=i[n].subtract(1,"day"))),i[n]=i[n].startOf("day")):delete i[n];return!!i.length&&(1===i.length?i[0]:i)},g=function(t,e){var r=[];e=P(e);for(var a=0;a<e.length;a++){var i=t.match(new RegExp(e[a],"gi"));i&&(r=r.concat(i))}return r},l=function(t,e,r,a,i){var n={},o=[],s={};if(h=i||_.holidays.active,h.hasOwnProperty(e))o.push(e);else if(fk=O(e,h))o.push(fk);else{for(var l in h)if(h.hasOwnProperty(l)){if(n[l]=g(e,l.split(/[\s,.-]+/).filter(function(t){return 2<t.length})).length,h[l].keywords_n)if(g(e,h[l].keywords_n).length){n[l]=0;continue}if(h[l].keywords_y){var f=g(e,h[l].keywords_y);if(!f||f.length!==h[l].keywords_y.length){n[l]=0;continue}n[l]+=f.length}if(h[l].keywords){var d=g(e,h[l].keywords);if(!d)continue;n[l]+=d.length}}for(var y in n)n[y]&&n.hasOwnProperty(y)&&(o.length&&n[y]!==n[o[0]]?n[y]>n[o[0]]&&(o=[y]):o.push(y))}if(!o.length)return!1;if(!1===a)return o;for(var c=0;c<o.length;c++){var u=v(t,h[o[c]].date,r);u&&(s[o[c]]=u)}return!!Object.keys(s).length&&s},f=function(t,e,r,a,i){var n=[];a&&(n={}),e=P(e),i||(i=_.holidays.active);for(var o=0;o<e.length;o++){var s=l(t,e[o],r,a,i);s&&(n=a?y(n,s):n.concat(s))}return n},p=function(t,e){var r=_.holidays.active,a={};for(var i in r)r.hasOwnProperty(i)&&(td=v(t,r[i].date,e))&&(a[i]=td);return a},d=function(t){if(regions=t.split("/"),t=regions[0].toLowerCase().replace(" ","_"),regions.shift(),!_.holidays[t])try{var e="./locale/";"build"==__dirname.split("/").slice(-1).pop()&&(e="."+e),require(e+t)}catch(t){}return!!_.holidays[t]&&(regions.length?function(t,e){var r=_.holidays[t],a={};if(r)for(var i=0;i<e.length;i++){var n=e[i].toLowerCase(),o=_.holidays[t+"/"+n];for(var s in o={},r)if(r.hasOwnProperty(s)){var h=r[s].regions||[],l=r[s].regions_n||[];h.length&&h.join().toLowerCase().split(),l.length&&l.join().toLowerCase().split(),(!h.length&&!l.length||h.length&&~h.indexOf(n)||l.length&&!~l.indexOf(n))&&(o[s]=r[s])}o&&(a=y(a,o))}return!!Object.keys(a).length&&a}(t,regions):_.holidays[t])},r=function(t,e,r,a){e||(e=1);for(var i=p(t,a),n=_(t),o=t.year(),s=[],h=0;h<e;h++)for(var l=_(n);;){var f=!1;if(r?l.add(1,"day"):l.subtract(1,"day"),l.year()!==o&&(i=p(l,a),o=l.year()),!Object.keys(i).length){f=!0;break}for(var d in i)if(i.hasOwnProperty(d)){for(var y=!1,c=P(i[d]),u=0;u<c.length;u++)if(l.isSame(c[u],"day")){s.push(c[u]),n=_(l),y=!0;break}if(y){f=!0;break}}if(f)break}return!!s.length&&(1===s.length?s[0]:s)},P=function(t){return t&&t.constructor!==Array?[t]:t},O=function(t,e){e.constructor===Object&&(e=Object.keys(e));for(var r=0;r<e.length;r++)if(t.toLowerCase()===e[r].toLowerCase())return e[r];return!1},y=function(t,e){return Object.assign({},t,e)};_.prototype.holiday=function(t,e){_.holidays.active;var r={},a=!1;if(t){t.constructor!==Array&&(a=!0,t=[t]);for(var i=0;i<t.length;i++)(td=l(this,t[i],e))&&(r=Object.assign({},r,td))}else r=p(this,e);var n=Object.keys(r);return!!n.length&&(1===n.length&&a?r[n[0]]:r)},_.prototype.holidays=function(t,e){return this.holiday(t,e)},_.prototype.isHoliday=function(t,e){var r,a,i=[];if(t?(t=P(t),r=this.holiday(t,e),a=!1):(r=p(this,e),a=!0),!r)return!1;for(var n in r)if(r.hasOwnProperty(n))for(var o=P(r[n]),s=0;s<o.length;s++)if(this.isSame(o[s],"day")){if(!a)return!0;i.push(n)}return!!i.length&&(1===i.length?i[0]:i)},_.prototype.previousHoliday=function(t,e){return r(this,t,!1,e)},_.prototype.previousHolidays=function(t,e){return this.previousHoliday(t,e)},_.prototype.nextHoliday=function(t,e){return r(this,t,!0,e)},_.prototype.nextHolidays=function(t,e){return this.nextHoliday(t,e)},_.prototype.holidaysBetween=function(t,e){t||(t=new Date),t=_(t).subtract(1,"day");for(var r=p(this,e),a=_(this),i=a.year(),n=[],o=0;o<t.diff(this,"days")&&(a.add(1,"day"),a.year()!==i&&(r=p(a,e),i=a.year()),Object.keys(r).length);o++)for(var s in r){for(var h=!1,l=P(r[s]),f=0;f<l.length;f++)if(a.isSame(l[f],"day")){n.push(l[f]),h=!0;break}if(h)break}return!!n.length&&n},_.holidays={active:{},active_last:{}},_.modifyHolidays={set:function(t,e){var r={};if(t.constructor===Array){for(var a=[],i=0;i<t.length;i++){var n=l(this,t[i],null,!1);n&&(a=a.concat(n))}if(a.length)for(var o in r=y(_.holidays.active))r.hasOwnProperty(o)&&(~a.indexOf(o)||delete r[o])}else if("string"==typeof t){var s=d(t);if(s)if(e){var h=f(this,e,!1,!1,s);for(i=0;i<h.length;i++)r[h[i]]=y(s[h[i]])}else r=y(s)}else r=t;return!Object.keys(r).length&&t!==r||Object.is(_.holidays.active,r)||(_.holidays.active_last=y(_.holidays.active),_.holidays.active=r),this},add:function(t,e){if("string"==typeof t){var r=d(t);if(t={},r)if(e)for(var a=f(this,e,!1,!1,r),i=0;i<a.length;i++)t[a[i]]=y(r[a[i]]);else t=r}return Object.keys(t).length&&(_.holidays.active_last=y(_.holidays.active),_.holidays.active=y(_.holidays.active,t)),this},remove:function(t){t=P(t);var e=f(this,t,!1,!1),r=y(_.holidays.active);if(e)for(var a=0;a<e.length;a++)delete r[e[a]];return Object.is(_.holidays.active,r)||(_.holidays.active_last=y(_.holidays.active),_.holidays.active=r),this},undo:function(){var t=y(_.holidays.active);return _.holidays.active=y(_.holidays.active_last),_.holidays.active_last=t,this},load:function(t){t=P(t);for(var e=0;e<t.length;e++)d(t[e]);return this},extendParser:function(t){return x.push(t),this}},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(module.exports=_)}).call(this);
//# sourceMappingURL=moment-holiday.min.js.map
